name: Deploy to Remote Server

on:
  push:
    branches:
      - develop
      - master

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Copy code to remote server
        run:
          sudo apt-get install sshpass -y
          sshpass -p ${{ secrets.RASPBERRY_PI_PASSWORD }} scp -o StrictHostKeyChecking=no -r . lucas-rasp@62.34.161.92:/home/lucas-rasp/Console -p 2048
        if: secrets.RASPBERRY_PI_PASSWORD
      - name: Run script on remote server
        run: 
          sshpass -p ${{ secrets.RASPBERRY_PI_PASSWORD }} ssh -o StrictHostKeyChecking=no lucas-rasp@62.34.161.92 -p 2048 'cd /home/lucas-rasp/Console && tmux send-keys -d Console "mvn spring-boot:run" C-m'
        if: secrets.RASPBERRY_PI_PASSWORD
